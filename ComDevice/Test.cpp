// ComDevice.cpp : 定义控制台应用程序的入口点。
//

#include "stdafx.h"
#include "ComDevice.hpp"

int main()
{
	char senddata[100] = {0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x01,0x02,0x03,0x04,0x05,0x06,0x07 ,
						  0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x01,0x02,0x03,0x04,0x05,0x06,0x07 ,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x01,0x02,0x03,0x04,0x05,0x06,0x07 };
	std::string SendData = { 0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x01,0x02,0x03,0x04,0x05,0x06,0x07 ,
		0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x01,0x02,0x03,0x04,0x05,0x06,0x07 ,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x01,0x02,0x03,0x04,0x05,0x06,0x07 };
	CSerialPort comtest(CSerialPort::COMTYPE::Asynchronous_mode);
	comtest.InitPort(1,9600,'N',8,1);
	//comtest.SetComTimeOut(20);
	while(true)
	{	
 		bool nCompleteFlag = false;
		long long beging= GetTickCount64();
		if (comtest.WriteData(SendData.c_str(), SendData.length(), nCompleteFlag,0))
		{	
			long long end = GetTickCount64();
			std::cout << "发送成功" << end - beging << std::endl;
		}
		else
		{
			std::cout << "发送失败" << std::endl;
		}

	}
	system("pause");
    return 0;
}

